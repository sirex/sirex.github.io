<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Atvirų duomenų katalogo metaduomenų analizė | Sirex web log</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://sirex.lt/posts/2020/atviru-duomenu-katalogo-metaduomenu-analize/">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Sirex">
<meta name="robots" content="noindex">
<meta property="og:site_name" content="Sirex web log">
<meta property="og:title" content="Atvirų duomenų katalogo metaduomenų analizė">
<meta property="og:url" content="https://sirex.lt/posts/2020/atviru-duomenu-katalogo-metaduomenu-analize/">
<meta property="og:description" content="Europos atvirų duomenų portalas atsiuntė klausimyną, kurio pagalba vertins
atvirų duomenų progresą Lietuvoje. Aš gavau užduotį paanalizuoti Lietuvos
atvirų duomenų katalogo (ADK) duomenis ir atsakyti ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-10-28T10:12:22+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
         <main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">Atvirų duomenų katalogo metaduomenų analizė</h1>
        <div class="metadata">
            <p class="dateline">
            <time class="published dt-published" datetime="2020-10-28T10:12:22+02:00" itemprop="datePublished" title="2020-10-28 10:12">2020-10-28 10:12</time></p>
        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="jp-Cell-inputWrapper">
<div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Europos atvirų duomenų portalas atsiuntė klausimyną, kurio pagalba vertins
atvirų duomenų progresą Lietuvoje. Aš gavau užduotį paanalizuoti <a href="https://data.gov.lt/">Lietuvos
atvirų duomenų katalogo</a> (ADK) duomenis ir atsakyti į kai
kuriuos klausimyno klausimus.</p>
<p>ADK viešojo API dokumentacija pasiekiama šiuo adresu:</p>
<p><a href="https://data.gov.lt/public/api/1">https://data.gov.lt/public/api/1</a></p>
<p>Dokumentacijoje nurodyta, kad ADK įgyvendina tik vieną API prieigos tašką:</p>
<p><a href="https://data.gov.lt/public/api/1/action/package_search">https://data.gov.lt/public/api/1/action/package_search</a></p>
<p>Kuris kaip suprantu atitinka CKAN
<a href="https://docs.ckan.org/en/2.9/api/#ckan.logic.action.get.package_search">package_search</a>,
o pats CKAN po dangčiu naudoja
<a href="https://lucene.apache.org/solr/guide/6_6/common-query-parameters.html">SOLR</a>.</p>
<h2 id="duomenu-surinkimas-1-bandymas">Duomenų surinkimas (1 bandymas)<a href="#duomenu-surinkimas-1-bandymas" class="headerlink" title="Permalink to this heading">¶</a></h2>
<p>Bandau žiūrėti ką grąžina API prieigos taškas:</p>

</div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>http -b <span class="s1">'https://data.gov.lt/public/api/1/action/package_search?rows=1'</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">

<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>{
    <span class="ansi-blue-intense-fg">"help"</span>: <span class="ansi-yellow-fg">"https://data.gov.lt/public/api/1/action/help_show?name=package_search"</span>,
    <span class="ansi-blue-intense-fg">"result"</span>: {
        <span class="ansi-blue-intense-fg">"count"</span>: <span class="ansi-blue-fg">1</span>,
        <span class="ansi-blue-intense-fg">"results"</span>: [
            {
                <span class="ansi-blue-intense-fg">"author"</span>: <span class="ansi-yellow-fg">""</span>,
                <span class="ansi-blue-intense-fg">"authorEmail"</span>: <span class="ansi-yellow-fg">""</span>,
                <span class="ansi-blue-intense-fg">"creatorUserId"</span>: <span class="ansi-yellow-fg">""</span>,
                <span class="ansi-blue-intense-fg">"id"</span>: <span class="ansi-yellow-fg">"{24C009EF-BD65-1890-F505-D0FBB3C16F43}"</span>,
                <span class="ansi-blue-intense-fg">"is_open"</span>: <span class="ansi-blue-fg">false</span>,
                <span class="ansi-blue-intense-fg">"metadata_created"</span>: <span class="ansi-yellow-fg">"2020-06-10T11:16:37"</span>,
                <span class="ansi-blue-intense-fg">"metadata_modified"</span>: <span class="ansi-yellow-fg">"2020-08-05T13:00:54"</span>,
                <span class="ansi-blue-intense-fg">"notes"</span>: <span class="ansi-yellow-fg">"Lietuvos nacionalinio atlaso žemėlapis - „Paros vidutinė oro temperatūra pakyla aukščiau ir nukrinta žemiau 0°C“. Autorius:A. Bukantis. Kartografas: G. Reginienė. Žemėlapis priklauso Nacionalinio atlaso skyriui - \"Gamta ir kraštovaizdis\", temai - \"Klimatas\""</span>,
                <span class="ansi-blue-intense-fg">"numResources"</span>: <span class="ansi-blue-fg">0</span>,
                <span class="ansi-blue-intense-fg">"numTags"</span>: <span class="ansi-blue-fg">0</span>,
                <span class="ansi-blue-intense-fg">"open"</span>: <span class="ansi-blue-fg">false</span>,
                <span class="ansi-blue-intense-fg">"private"</span>: <span class="ansi-blue-fg">false</span>,
                <span class="ansi-blue-intense-fg">"state"</span>: <span class="ansi-yellow-fg">"active"</span>,
                <span class="ansi-blue-intense-fg">"title"</span>: <span class="ansi-yellow-fg">"WMS. Lietuvos nacionalinio atlaso žemėlapis - Paros vidutinė oro temperatūra pakyla aukščiau ir nukrinta žemiau 0°C"</span>,
                <span class="ansi-blue-intense-fg">"type"</span>: <span class="ansi-yellow-fg">"dataset"</span>,
                <span class="ansi-blue-intense-fg">"version"</span>: <span class="ansi-yellow-fg">"1"</span>
            }
        ],
        <span class="ansi-blue-intense-fg">"sort"</span>: <span class="ansi-yellow-fg">"relevance asc, metadata_modified desc"</span>
    },
    <span class="ansi-blue-intense-fg">"success"</span>: <span class="ansi-blue-fg">true</span>
}

</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper">
<div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Kaip suprantu, man reikia susirinkti visus puslapius ir sujungti juos į vieną
didelį sąrašą. Kadangi portale yra mažiau nei 1000 duomenų rinkinių, tai visus
rinkinius užsikrauti į RAM neturėtų būti problema.</p>

</div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">'https://data.gov.lt/public/api/1/action/package_search'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'rows'</span><span class="p">:</span> <span class="n">rows</span><span class="p">,</span>
        <span class="s1">'start'</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span>
        <span class="s1">'sort'</span><span class="p">:</span> <span class="s1">'metadata_created'</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="k">assert</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">url</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">'result'</span><span class="p">][</span><span class="s1">'results'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">datasets</span> <span class="o">+=</span> <span class="n">results</span>
        <span class="n">start</span> <span class="o">+=</span> <span class="n">rows</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">

<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-44-aa02cac1f045&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>         <span class="ansi-blue-fg">'sort'</span><span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">'metadata_created'</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>     })
<span class="ansi-green-fg">---&gt; 13</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">assert</span> resp<span class="ansi-blue-fg">.</span>ok<span class="ansi-blue-fg">,</span> resp<span class="ansi-blue-fg">.</span>url
<span class="ansi-green-intense-fg ansi-bold">     14</span>     results <span class="ansi-blue-fg">=</span> resp<span class="ansi-blue-fg">.</span>json<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'result'</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'results'</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>     <span class="ansi-green-fg">if</span> results<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">AssertionError</span>: https://data.gov.lt/public/api/1/action/package_search?rows=50&amp;start=250&amp;sort=metadata_created</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper">
<div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>O, pavyko gauti 500 klaidą, ir jokios informacijos apie tai, kas galėjo būti blogai.</p>
<p>Gal reikia pabandyti pasiimti visus duomenis vienos užklausos pagalba?</p>

</div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">

<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://data.gov.lt/public/api/1/action/package_search'</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">'rows'</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">})</span>
<span class="k">assert</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">

<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-42-9df02160e4d9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>     <span class="ansi-blue-fg">'rows'</span><span class="ansi-blue-fg">:</span> <span class="ansi-cyan-fg">1000</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> })
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">assert</span> resp<span class="ansi-blue-fg">.</span>ok
<span class="ansi-green-intense-fg ansi-bold">      5</span> 

<span class="ansi-red-fg">AssertionError</span>: </pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper">
<div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Neveikia. Įdomu, kaip duomenis
<a href="https://www.europeandataportal.eu/data/datasets?catalog=data-gov-lt">susiimportavo</a>
Europos atvirų duomenų portalas?</p>

</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav></nav></aside><nav id="menu"><ul>
<li><a href="../../../">Index</a></li>
                <li><a href="../../">Archive</a></li>
                <li><a href="../../../tags/">Tags</a></li>
                <li><a href="../../../rss.xml">RSS feed</a></li>

    
    
    
    </ul></nav><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article></main>
</div>
                <script src="../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>